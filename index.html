<!DOCTYPE html>
<html lang="en">
<head>
    <!-- META TAGS AND TITLE -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malte Stoepke's Portfolio OS</title>
    
    <!-- EXTERNAL STYLESHEETS -->
    <!-- 98.css for Windows 98 style UI -->
    <link rel="stylesheet" href="https://unpkg.com/98.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- INLINE CUSTOM STYLES -->
    <style>
        /* GLOBAL STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "MS Sans Serif", "Tahoma", Arial, sans-serif;
        }
        
        /* BODY BACKGROUND AND LAYOUT */
        body {
            background: #008080 url('https://static.wikitide.net/windowswallpaperwiki/2/24/Clouds_%28Windows_95%29.png') no-repeat center center fixed;
            background-size: cover;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        /* DESKTOP AREA */
        .desktop {
            flex-grow: 1;
            padding: 10px;
            position: relative;
            z-index: 1;
        }
        
        /* DESKTOP ICON STYLES */
        .icon {
            position: absolute;
            text-align: center;
            cursor: pointer;
            padding: 8px;
            width: 90px;
            border: 1px solid transparent;
            user-select: none;
            display: block !important;
            visibility: visible !important;
        }
       
        .icon.draggable:hover {
            background: rgba(0, 0, 128, 0.5);
            border: 1px dotted white;
        }
        .icon img {
            width: 32px;
            height: 32px;
            object-fit: contain;
        }
        .icon p {
            color: white;
            text-shadow: 1px 1px black;
            font-size: 11px;
            padding: 2px;
            word-wrap: break-word;
            background: #008080;
        }
       
        .icon.selected p {
            background-color: #000080;
        }
        .icon[data-id="maya"] {
            z-index: 2 !important;
        }
        
        /* WINDOW STYLES */
        .window {
            display: none;
            position: absolute;
            top: 10%;
            left: 10%;
            width: 600px;
            min-width: 250px;
            min-height: 150px;
            max-height: 80%;
            overflow: hidden;
            cursor: default;
            z-index: 10;
            resize: both;
            border: 2px solid #c0c0c0;
            box-shadow: 2px 2px 0px #000000, -2px -2px 0px #ffffff;
            background: #c0c0c0;
        }
        .window.maximized {
            width: 100% !important;
            height: calc(100vh - 30px) !important;
            top: 0 !important;
            left: 0 !important;
            max-height: none;
            resize: none;
        }
        .window.active {
            display: block;
        }
       
        /* TITLE BAR STYLES */
        .title-bar {
            position: relative;
            height: 22px;
            padding: 2px 4px;
            cursor: move;
            background: linear-gradient(to right, #000080, #1084d0);
            color: white;
            font-size: 12px;
            line-height: 18px;
        }
        .title-bar-text {
            display: inline-block;
            padding-left: 4px;
        }
        .title-bar-controls {
            position: absolute;
            right: 4px;
            top: 3px;
            display: flex;
            gap: 2px;
        }
        .title-bar-controls button {
            width: 16px;
            height: 16px;
            padding: 0;
            margin: 0;
            background: #c0c0c0;
            border: 1px solid #000;
            border-top-color: #fff;
            border-left-color: #fff;
            cursor: pointer;
        }
        
        /* WINDOW BODY STYLES */
        .window-body {
            margin-top: 22px;
            padding: 8px;
            background: #dfdfdf;
            height: calc(100% - 22px);
            overflow: auto;
            font-size: 12px;
        }
        .window-body img.artwork-image {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 8px auto;
            border: 2px inset #ffffff;
        }
        .artwork-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .artwork-gallery img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border: 2px outset #ffffff;
            cursor: pointer;
        }
        
        /* TASKBAR STYLES */
        .taskbar {
            height: 30px;
            background: #c0c0c0;
            border-top: 2px solid #ffffff;
            display: flex;
            align-items: center;
            padding: 0 2px;
            position: relative;
            z-index: 100;
            flex-shrink: 0;
        }
        .start-button {
            font-weight: bold;
            padding: 2px 6px;
            height: 26px;
            display: flex;
            align-items: center;
            background: #c0c0c0;
            border: 2px outset #ffffff;
        }
        .start-button img {
            width: 20px;
            height: 20px;
            margin-right: 4px;
        }
       
        .taskbar-time {
            font-size: 11px;
            padding: 2px 4px;
            border: 1px solid #808080;
            border-right: 2px solid #fff;
            border-bottom: 2px solid #fff;
            min-width: 80px;
            text-align: center;
            margin-left: 4px;
        }
       
        .taskbar-user {
            font-size: 11px;
            padding: 2px 6px;
            border: 1px solid #808080;
            margin: 0 2px;
        }
        .taskbar-apps {
            display: flex;
            flex-grow: 1;
            margin: 0 4px;
            gap: 2px;
            overflow: hidden;
        }
        .taskbar-app {
            padding: 2px 6px;
            font-size: 12px;
            cursor: pointer;
            max-width: 150px;
            min-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex-shrink: 1;
            background: #c0c0c0;
            border: 2px outset #ffffff;
        }
       
        .taskbar-app.active {
            border: 2px inset #c0c0c0;
        }
       
        /* START MENU STYLES */
        .start-menu {
            display: none;
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 200px;
            background: #c0c0c0;
            border-top: 2px solid #ffffff;
            border-left: 2px solid #ffffff;
            border-right: 2px solid #000;
            border-bottom: 2px solid #000;
            z-index: 1000;
        }
        .start-menu.active {
            display: block;
        }
        .start-menu ul {
            list-style: none;
            padding: 2px;
            margin: 0;
        }
        .start-menu li {
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
        }
        .start-menu li img {
            width: 22px;
            height: 22px;
            margin-right: 8px;
        }
        .start-menu li:hover {
            background: #000080;
            color: white;
        }
       
        .start-menu-separator {
            height: 1px;
            background: #808080;
            border-bottom: 1px solid #fff;
            margin: 4px 0;
        }
        
        /* LOGIN BOX STYLES */
        .login-box {
            background: #c0c0c0;
            padding: 20px;
            width: 320px;
            text-align: center;
            border: 2px outset #ffffff;
        }
       
        .login-title {
            background: #000080;
            color: white;
            padding: 4px;
            margin: -20px -20px 20px -20px;
            font-weight: bold;
            font-size: 12px;
        }
       
        .login-field {
            margin: 12px 0;
            text-align: left;
        }
       
        .login-field label {
            display: block;
            margin-bottom: 4px;
            font-size: 12px;
        }
        .login-field input, .login-field textarea {
            width: 100%;
            padding: 4px;
        }
       
        .login-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        /* MINESWEEPER (PIXELSWEEPER) STYLES */
        .minesweeper-board {
            display: grid;
            gap: 1px;
            background: #808080;
            padding: 8px;
            border: 2px inset #fff;
            margin: 0 auto;
        }
        .minesweeper-cell {
            width: 20px;
            height: 20px;
            background: #c0c0c0;
            border: 2px outset #fff;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
        }
       
        .minesweeper-cell.revealed {
            border: 1px solid #808080;
        }
       
        .minesweeper-cell.mine {
            background-color: red;
        }
       
        .color-1 { color: blue; }
        .color-2 { color: green; }
        .color-3 { color: red; }
        .color-4 { color: navy; }
        .color-5 { color: maroon; }
        .color-6 { color: teal; }
        .color-7 { color: black; }
        .color-8 { color: gray; }
        
        /* CONTEXT MENU STYLES */
        .context-menu {
            position: absolute;
            background: #c0c0c0;
            border-top: 2px solid #ffffff;
            border-left: 2px solid #ffffff;
            border-right: 2px solid #000;
            border-bottom: 2px solid #000;
            z-index: 10000;
            font-size: 12px;
            padding: 2px;
            display: none;
        }
        .context-menu ul {
            list-style: none;
        }
        .context-menu li {
            padding: 4px 18px;
            cursor: pointer;
        }
        .context-menu li:hover {
            background: #000080;
            color: white;
        }
        
        /* ARTWORK GALLERY STYLES */
        .artwork-gallery img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border: 2px outset #ffffff;
            cursor: pointer;
        }
       
        /* PAINT APPLICATION STYLES */
        .paint-canvas {
            border: 1px solid black;
            background: white;
            cursor: crosshair;
            display: block;
            margin: 0 auto;
        }
        .paint-tools {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
        }
        .tool-button {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #c0c0c0;
            border: 2px outset #ffffff;
            cursor: pointer;
        }
        .tool-button.active {
            border: 2px inset #c0c0c0;
        }
        .color-picker {
            display: flex;
            gap: 4px;
            margin-top: 8px;
        }
        .color-option {
            width: 24px;
            height: 24px;
            border: 2px outset #ffffff;
            cursor: pointer;
        }
        .color-option.selected {
            border: 2px inset #c0c0c0;
        }
        
        /* BLOG-SPECIFIC STYLES */
        .blog-window .window-body {
            padding: 0;
            height: calc(100% - 66px); /* Adjust for toolbar and status bar */
            background: #ffffff;
        }
        .blog-toolbar {
            background: #c0c0c0;
            border-bottom: 2px inset #ffffff;
            padding: 4px;
            display: flex;
            gap: 4px;
        }
        .blog-toolbar button {
            background: #c0c0c0;
            border: 2px outset #ffffff;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
        }
        .blog-toolbar button:hover {
            background: #e0e0e0;
        }
        .blog-status-bar {
            background: #c0c0c0;
            border-top: 2px inset #ffffff;
            padding: 2px 4px;
            font-size: 11px;
            color: #000080;
            position: absolute;
            bottom: 0;
            width: 100%;
        }
        .blog-post {
            margin: 10px;
            padding: 10px;
            background: #ffffff;
            border: 2px outset #c0c0c0;
            transition: transform 0.2s ease;
            cursor: pointer;
        }
        .blog-post:hover {
            transform: scale(1.02);
            box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.3);
        }
        .blog-post img {
            max-width: 100%;
            height: auto;
            border: 2px inset #ffffff;
            margin: 10px 0;
            animation: pulse 2s infinite;
        }
        .blog-post h3 {
            font-size: 14px;
            color: #000080;
            margin-bottom: 5px;
            text-decoration: underline;
            transition: color 0.3s;
            animation: text-blink 1s infinite;
        }
        .blog-post h3:hover {
            color: #ff00ff;
        }
        .blog-post .date {
            font-size: 10px;
            color: #808080;
            margin-bottom: 10px;
            font-style: italic;
            animation: fade-in 1.5s ease-in-out infinite;
        }
        .blog-post p {
            font-size: 12px;
            line-height: 1.5;
            animation: text-slide 10s linear infinite;
        }
        .blog-controls {
            display: flex;
            gap: 10px;
            margin: 10px;
        }
        .blog-controls button {
            background: #c0c0c0;
            border: 2px outset #ffffff;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        .blog-controls button:hover {
            background: #e0e0e0;
        }
        .blog-form {
            display: none;
            margin: 10px;
            padding: 10px;
            background: #ffffff;
            border: 2px inset #c0c0c0;
        }
        .blog-form.active {
            display: block;
        }
        .blog-form input,
        .blog-form textarea {
            width: 100%;
            margin-bottom: 10px;
            padding: 4px;
            font-size: 12px;
            border: 2px inset #c0c0c0;
        }
        .blog-form textarea {
            height: 100px;
            resize: vertical;
        }
        
        /* ANIMATIONS FOR BLOG */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes text-blink {
            0%, 50% { color: #000080; }
            51%, 100% { color: #ff0000; }
        }
        @keyframes fade-in {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        @keyframes text-slide {
            0% { transform: translateX(0); }
            50% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }
        
        /* MEDIA QUERIES FOR RESPONSIVENESS */
        @media (max-width: 768px) {
            .window {
                width: 95%;
                left: 2.5%;
            }
           
            .icon {
                width: 70px;
            }
           
            .icon img {
                width: 24px;
                height: 24px;
            }
        }
        @media screen and (max-width: 600px), screen and (orientation: portrait) {
            .window {
                width: 100% !important;
                height: calc(100vh - 40px) !important;
                top: 0 !important;
                left: 0 !important;
                position: fixed;
                resize: none;
            }
            .desktop {
                display: flex;
                flex-wrap: wrap;
                justify-content: flex-start;
                align-content: flex-start;
            }
            .icon {
                position: relative;
                margin: 10px;
                width: 80px;
            }
            .taskbar {
                height: 40px;
            }
            .start-button {
                height: 36px;
            }
            .start-menu {
                width: 100%;
                bottom: 40px;
                left: 0;
            }
            .taskbar-time {
                min-width: 120px;
            }
        }

        /* LOADING SCREEN STYLES (Windows 95-like) */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000080; /* Dark blue like Windows 95 boot */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 16px;
            z-index: 1000;
        }
        #loading-screen img {
            margin-bottom: 20px;
        }
        #loading-screen h2 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        #loading-screen p {
            font-size: 14px;
            margin-bottom: 20px;
        }
        .loading-bar {
            width: 300px;
            height: 10px;
            background: #c0c0c0;
            border: 1px solid #000;
            overflow: hidden;
        }
        .loading-progress {
            width: 0;
            height: 100%;
            background: #ffffff; /* Changed to white for visibility */
            transition: width 0.2s;
        }

        /* AUDIO CONTROL STYLES (Placed in taskbar) */
        .audio-control {
            font-size: 11px;
            padding: 2px 4px;
            margin-left: 4px;
            cursor: pointer;
        }

        /* SELECTION RECTANGLE FOR MULTI-SELECT */
        .selection-rect {
            position: absolute;
            background: rgba(0, 0, 255, 0.2);
            border: 1px solid blue;
            pointer-events: none;
            z-index: 5;
        }
        
        /* MY COMPUTER SETUP STYLES */
        .setup-section {
            margin-bottom: 20px;
            animation: fadeIn 1s ease-in;
        }
        .setup-section h3 {
            color: #000080;
            font-size: 14px;
            margin-bottom: 10px;
            text-decoration: underline;
        }
        .setup-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 5px;
            border: 1px solid #c0c0c0;
            background: #ffffff;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .setup-item:hover {
            transform: scale(1.05);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }
        .setup-item img {
            width: 32px;
            height: 32px;
            margin-right: 10px;
            animation: pulse 2s infinite;
        }
        .setup-item p {
            font-size: 12px;
        }
        .dark-bg {
            background: black;
            padding: 5px;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ABOUT ME STYLES */
        #about-window .window-body {
            font-family: 'Lucida Console', monospace;
            line-height: 1.6;
            color: #000;
            background: white;
            padding: 20px;
            overflow-y: auto;
        }
        #about-window img {
            float: right;
            width: 150px;
            height: auto;
            margin: 0 0 10px 10px;
            border: 2px inset #c0c0c0;
            animation: pulse 2s infinite;
        }
        #about-window p {
            margin-bottom: 15px;
        }
        .typewriter {
            overflow: hidden; /* Ensures the content is not revealed until the animation */
            border-right: .15em solid orange; /* The typwriter cursor */
            white-space: nowrap; /* Keeps the content on a single line */
            margin: 0 auto; /* Gives that scrolling effect as the typing happens */
            letter-spacing: .15em; /* Adjust as needed */
            animation: 
              typing 3.5s steps(40, end),
              blink-caret .75s step-end infinite;
        }
        
        /* The typing effect */
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        /* The typewriter cursor effect */
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: orange; }
        }

        /* RECYCLE BIN CRAZY STYLES */
        #recycle-window .window-body {
            background: linear-gradient(45deg, #ff0000, #00ff00, #0000ff);
            background-size: 400% 400%;
            animation: rainbow 15s ease infinite;
            padding: 20px;
            color: white;
            text-shadow: 1px 1px 2px black;
        }
        #recycle-window ul {
            list-style: none;
            padding: 0;
        }
        #recycle-window li {
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px dashed yellow;
            animation: spin 2s linear infinite alternate, color-change 3s infinite;
            transition: transform 0.3s;
        }
        #recycle-window li:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.8);
        }
        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes spin {
            0% { transform: rotate(-5deg); }
            100% { transform: rotate(5deg); }
        }
        @keyframes color-change {
            0% { color: red; }
            33% { color: green; }
            66% { color: blue; }
            100% { color: red; }
        }

        /* CUSTOM CLIPPY STYLES */
        #custom-clippy {
            position: fixed;
            bottom: 50px;
            right: 20px;
            z-index: 9999;
            display: none;
        }
        #custom-clippy img {
            width: 100px;
            height: auto;
        }
        #speech-bubble {
            position: fixed;
            bottom: 160px;
            right: 140px;
            background: #ffffe0;
            border: 2px solid #000;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
            max-width: 300px;
            z-index: 9998;
            display: none;
            font-size: 12px;
        }
        #speech-bubble:after {
            content: '';
            position: absolute;
            bottom: -20px;
            right: 20px;
            border-width: 10px;
            border-style: solid;
            border-color: #ffffe0 transparent transparent transparent;
        }
        #speech-bubble button {
            margin-top: 10px;
            padding: 5px 10px;
            background: #c0c0c0;
            border: 2px outset #ffffff;
            cursor: pointer;
        }
        #clippy-btn {
            background: #c0c0c0;
            border: 2px outset #ffffff;
            padding: 2px 6px;
            height: 26px;
            cursor: pointer;
            margin-left: 4px;
        }
    </style>
</head>
<body>
    <!-- AUDIO ELEMENTS FOR SOUNDS -->
    <audio id="startup-sound" src="https://www.winhistory.de/more/winstart/ogg/win95.ogg" preload="auto"></audio>
    <audio id="error-sound" src="https://orangefreesounds.com/wp-content/uploads/2020/09/Windows-95-error-sound.mp3" preload="auto"></audio>
    <audio id="window-open-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3"></audio>
    <audio id="window-close-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-jump-arcade-game-239.mp3"></audio>
    <audio id="click-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-mouse-click-close-1113.mp3"></audio>
   
    <!-- LOADING SCREEN -->
    <div id="loading-screen">
        <img src="https://win98icons.alexmeub.com/icons/png/windows-0.png" alt="Windows 95" width="48" height="48">
        <h2>Portfolio OS</h2>
        <p>Starting...</p>
        <p>Made by Malte Stoepke</p>
        <div class="loading-bar">
            <div class="loading-progress" id="loading-progress"></div>
        </div>
    </div>
    
    <!-- LOGIN SCREEN -->
    <div id="login-screen" style="display: none;">
        <div class="login-box">
            <div class="login-title">Portfolio OS Login</div>
            <img src="https://win98icons.alexmeub.com/icons/png/keys-4.png" alt="Keys" width="48" height="48" style="margin-bottom: 10px;">
            <div class="login-field">
                <label for="username"><u>U</u>ser name:</label>
                <input type="text" id="username" value="Malte Stoepke">
            </div>
            <div class="login-field">
                <label for="password"><u>P</u>assword:</label>
                <input type="password" id="password" value="Maus_123">
            </div>
            <div class="login-buttons field-row" style="justify-content: center;">
                <button onclick="login()"><img src="https://win98icons.alexmeub.com/icons/png/key-2.png" style="width:16px; height:16px; margin-right: 5px;">Log On</button>
                <button onclick="guestLogin()">Guest</button>
            </div>
        </div>
    </div>
   
    <!-- DESKTOP AREA WITH ICONS -->
    <div class="desktop" id="desktop" style="display: none;">
        <!-- CORE ICONS -->
        <div class="icon" data-id="my-computer" style="left: 20px; top: 20px;" ondblclick="openWindow('my-computer-window')">
            <img src="https://win98icons.alexmeub.com/icons/png/computer-4.png" alt="My Computer">
            <p>My Computer</p>
        </div>
        <div class="icon" data-id="about" style="left: 20px; top: 100px;" ondblclick="openWindow('about-window')">
            <img src="https://win98icons.alexmeub.com/icons/png/notepad_file-1.png" alt="About">
            <p>About Me.txt</p>
        </div>
        <div class="icon" data-id="paint" style="left: 20px; top: 180px;" ondblclick="openPaint()">
            <img src="https://win98icons.alexmeub.com/icons/png/paint_old-0.png" alt="Paint">
            <p>Paint</p>
        </div>
        <div class="icon" data-id="pixelsweeper" style="left: 20px; top: 260px;" ondblclick="openWindow('pixelsweeper-window')">
            <img src="https://win98icons.alexmeub.com/icons/png/game_mine_2-1.png" alt="PixelSweeper">
            <p>PixelSweeper</p>
        </div>
        <div class="icon" data-id="recycle" style="left: 20px; top: 340px;" ondblclick="openWindow('recycle-window')">
            <img src="https://win98icons.alexmeub.com/icons/png/recycle_bin_full_cool-3.png" alt="Recycle Bin">
            <p>Recycle Bin</p>
        </div>
        
        <!-- PROJECT FOLDER ICONS -->
        <!-- Add or remove project folders here by copying the structure -->
        <div class="icon" data-id="friedrich" style="left: calc(100% - 120px); top: 20px;" ondblclick="openFriedrich()">
            <img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png" alt="Friedrich">
            <p>Friedrich</p>
        </div>
        <div class="icon" data-id="the-nyrrik" style="left: calc(100% - 120px); top: 100px;" ondblclick="openTheNyrrik()">
            <img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png" alt="The Nyrrik">
            <p>The Nyrrik</p>
        </div>
        <div class="icon" data-id="berlin-girl-melody" style="left: calc(100% - 120px); top: 180px;" ondblclick="openBerlinGirlMelody()">
            <img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png" alt="Berlin-Girl: Melody">
            <p>Berlin-Girl: Melody</p>
        </div>
        <div class="icon" data-id="wanderlust-the-roadtrip" style="left: calc(100% - 120px); top: calc(100vh - 200px);" ondblclick="openWanderlustTheRoadtrip()">
            <img src="https://win98icons.alexmeub.com/icons/png/joystick-5.png" alt="Wanderlust: The Roadtrip">
            <p>Wanderlust: The Roadtrip</p>
        </div>
        <div class="icon" data-id="maxs-game" style="left: calc(100% - 120px); top: calc(100vh - 280px);" ondblclick="openMaxsGame()">
            <img src="https://win98icons.alexmeub.com/icons/png/joystick-5.png" alt="Max's Game">
            <p>Max's Game</p>
        </div>
        <div class="icon" data-id="undo" style="left: calc(100% - 120px); top: calc(100vh - 360px);" ondblclick="openUndo()">
            <img src="https://win98icons.alexmeub.com/icons/png/joystick-5.png" alt="Undo">
            <p>Undo</p>
        </div>
        
        <!-- OTHER ICONS -->
        <div class="icon" data-id="maya" style="left: 20px; top: 420px;" ondblclick="openMaya()">
            <img src="https://images.seeklogo.com/logo-png/0/1/alias-maya-logo-png_seeklogo-6538.png" alt="Maya 1.0">
            <p>Maya 1.0</p>
        </div>
        <div class="icon" data-id="blog" style="left: 20px; top: 500px;" ondblclick="openWindow('blog-window')">
            <img src="https://win98icons.alexmeub.com/icons/png/msie2-5.png" alt="Blog">
            <p>My Blog</p>
        </div>
        <div class="icon" data-id="artstation" style="left: 20px; top: 580px;" ondblclick="window.open('https://www.artstation.com/malte_stoepke', '_blank')">
            <img src="https://www.artstation.com/assets/about/logo/logo-artstation-vertical-ec60efc77a6d4b7aa4b177d65b5726766b4e6ad194c90bbb588ecb65e481dd01.png" alt="Artstation">
            <p>Artstation</p>
        </div>
    </div>
   
    <!-- WINDOW DEFINITIONS -->
    <!-- Each div here is a window that opens on double-click. Add/remove windows as needed. -->
    <div class="window" id="my-computer-window" style="width: 600px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">My Computer</div>
            <div class="title-bar-controls">
                <button aria-label="Minimize" onclick="minimizeWindow('my-computer-window')"></button>
                <button aria-label="Maximize" onclick="maximizeWindow('my-computer-window')"></button>
                <button aria-label="Close" onclick="closeWindow('my-computer-window')"></button>
            </div>
        </div>
        <div class="window-body">
            <h2>Welcome to My Setup!</h2>
            <p>Discover the powerful tools and hardware that fuel my creative process in 3D art and game development.</p>
            
            <div class="setup-section">
                <h3>Software Tools</h3>
                <div class="setup-item dark-bg">
                    <img src="https://maxonassets.imgix.net/images/Products/ZBrush/ZBrush-Logo-1c.png?fm=webp&auto=format,compress&w=1920&h=1704&ar=16:9&fit=clip&crop=faces&q=80" alt="ZBrush">
                    <p>ZBrush - My go-to for high-detail sculpting and bringing characters to life.</p>
                </div>
                <div class="setup-item">
                    <img src="https://damassets.autodesk.net/content/dam/autodesk/www/products/responsive-imagery/responsive-lockups-banners/2019/maya-2019-banner-lockup-1200x132.png" alt="Maya">
                    <p>Maya - Essential for precise modeling, rigging, and smooth animations.</p>
                </div>
                <div class="setup-item">
                    <img src="https://win98icons.alexmeub.com/icons/png/paint_old-0.png" alt="Clip Studio Paint">
                    <p>Clip Studio Paint - Perfect for digital drawing, concept art, and storyboarding.</p>
                </div>
                <div class="setup-item">
                    <img src="https://cdn.serif.com/affinity/img/global/logos/universal-logo-180320221056.png" alt="Affinity Suite">
                    <p>Affinity Suite - Versatile for photo editing, vector design, and layout work.</p>
                </div>
                <div class="setup-item">
                    <img src="https://www.adobe.com/cc-shared/assets/img/product-icons/svg/substance-3d-painter-64.svg" alt="Substance 3D Painter">
                    <p>Substance 3D Painter - Advanced texturing tool for realistic materials and PBR workflows.</p>
                </div>
                <div class="setup-item">
                    <img src="https://www.citypng.com/public/uploads/preview/unity-game-engine-logo-icon-png-11617406238u3ow7l5xpl.png" alt="Unity">
                    <p>Unity - Powerful engine for developing immersive games and interactive experiences.</p>
                </div>
                <div class="setup-item">
                    <img src="https://www.pureref.com/images/PureRef.svg" alt="PureRef">
                    <p>PureRef - Ideal for creating and organizing reference moodboards efficiently.</p>
                </div>
            </div>
            
            <div class="setup-section">
                <h3>Hardware Setup</h3>
                <div class="setup-item">
                    <img src="https://win98icons.alexmeub.com/icons/png/computer-4.png" alt="Lenovo Legion">
                    <p>Lenovo Legion 5 Pro (2023) - Equipped with RTX 4060 GPU, Ryzen 7 CPU, 48GB DDR5 RAM, and 5TB total SSD storage for high-performance rendering and multitasking.</p>
                </div>
                <div class="setup-item">
                    <img src="https://win98icons.alexmeub.com/icons/png/tablet-0.png" alt="XP Pen">
                    <p>XP-Pen Artist Pro 24 (4K, 2nd Gen) - My primary display tablet for precise drawing and sculpting with stunning clarity.</p>
                </div>
            </div>
        </div>
    </div>
   
    <div class="window" id="about-window" style="width: 600px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">About Me.txt - Notepad</div>
            <div class="title-bar-controls">
                <button aria-label="Minimize" onclick="minimizeWindow('about-window')"></button>
                <button aria-label="Maximize" onclick="maximizeWindow('about-window')"></button>
                <button aria-label="Close" onclick="closeWindow('about-window')"></button>
            </div>
        </div>
        <div class="window-body" style="background: white; font-family: 'Lucida Console', monospace;">
            <img src="https://cdnb.artstation.com/p/users/avatars/012/151/525/large/da513e8f4a0d5d5688dce4805d2e6c88.jpg?1718660145" alt="Malte Stoepke">
            <p class="editable-field typewriter" contenteditable="false" id="about-bio"><strong>Malte Stoepke - 3D Artist</strong></p>
            <br>
            <p class="editable-field typewriter" contenteditable="false" id="about-desc">Hello! I'm Malte, a passionate 3D artist obsessed with crafting characters and creatures.<br><br>I pour my heart into every step: developing a character's story, sketching concepts, and sculpting in 3D with meticulous detail.<br><br>I love transforming ideas into game-ready assets through retopology, and I can even import and animate in Unreal Engine 5 (check out my work: [Friedrich]).<br><br>Perfection is my goal—I spend hours refining every aspect because I'm deeply passionate about my craft!<br><br>I'm in my third year of a four-year Bachelor's in Creative Media and Game Technologies (CMGT) at Hanze University of Applied Sciences in Groningen, Netherlands.<br><br>Currently, I'm studying abroad at Kansai Gaidai University in Japan for the first semester, immersing in their Asian Studies program.<br><br>After this, I'm seeking an internship in gaming or animation.<br><br>I have programming experience in C# with Unity, plus HTML and JavaScript (I built this website myself!).<br><br>Some say my skills are broad, but understanding game programming enhances collaboration with developers—key for great projects.<br><br>I'm experienced in Scrum/Agile, serving as product owner or project manager.<br><br>Last semester, I led a Bosch student project as project manager and lead artist—we delivered successfully, delighting the client (see [Wanderlust: The Roadtrip]).<br><br>I'm incredibly passionate about my work and invite you to explore my portfolio!</p>
            <br>
            <p class="editable-field typewriter" contenteditable="false" id="about-contact">Short on time? Visit my ArtStation for a quick look at my creations!</p>
            <div class="edit-controls">
                <button onclick="saveAboutEdits()">Save Changes</button>
            </div>
        </div>
    </div>
   
    <div class="window" id="pixelsweeper-window" style="width: auto; height: auto;">
        <div class="title-bar">
            <div class="title-bar-text">PixelSweeper</div>
            <div class="title-bar-controls">
                <button aria-label="Minimize" onclick="minimizeWindow('pixelsweeper-window')"></button>
                <button aria-label="Close" onclick="closeWindow('pixelsweeper-window')"></button>
            </div>
        </div>
        <div class="window-body">
            <div class="minesweeper-controls">
                <button onclick="startMinesweeper(8, 8, 10)">Beginner</button>
                <button onclick="startMinesweeper(16, 16, 40)">Intermediate</button>
                <button onclick="startMinesweeper(30, 16, 99)">Expert</button>
            </div>
            <div id="minesweeper-board" class="minesweeper-board"></div>
        </div>
    </div>
    <div class="window" id="maya-window" style="width: 600px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">Maya 1.0</div>
            <div class="title-bar-controls">
                <button aria-label="Minimize" onclick="minimizeWindow('maya-window')"></button>
                <button aria-label="Maximize" onclick="maximizeWindow('maya-window')"></button>
                <button aria-label="Close" onclick="closeWindow('maya-window')"></button>
            </div>
        </div>
        <div class="window-body">
            <canvas id="maya-canvas" width="580" height="340"></canvas>
        </div>
    </div>
    <div class="window" id="recycle-window" style="width: 400px; height: 300px;">
        <div class="title-bar">
            <div class="title-bar-text">Recycle Bin</div>
            <div class="title-bar-controls">
                <button aria-label="Minimize" onclick="minimizeWindow('recycle-window')"></button>
                <button aria-label="Maximize" onclick="maximizeWindow('recycle-window')"></button>
                <button aria-label="Close" onclick="closeWindow('recycle-window')"></button>
            </div>
        </div>
        <div class="window-body">
            <p>Unfinished work:</p>
            <ul>
                <li>Project 1: Incomplete 3D model of a dragon - needs more scales!</li>
                <li>Project 2: Draft blog post about AI in art - half-written ideas.</li>
                <li>Test Item 1: Forgotten sketch - spinning wildly.</li>
                <li>Test Item 2: Broken code snippet - flashing colors.</li>
            </ul>
        </div>
    </div>
    <div class="window blog-window" id="blog-window" style="width: 600px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">My Blog - Internet Explorer</div>
            <div class="title-bar-controls">
                <button aria-label="Minimize" onclick="minimizeWindow('blog-window')"></button>
                <button aria-label="Maximize" onclick="maximizeWindow('blog-window')"></button>
                <button aria-label="Close" onclick="closeWindow('blog-window')"></button>
            </div>
        </div>
        <div class="blog-toolbar">
            <button onclick="goBack()"><i class="fas fa-arrow-left"></i> Back</button>
            <button onclick="goForward()"><i class="fas fa-arrow-right"></i> Forward</button>
            <button onclick="refreshBlog()"><i class="fas fa-sync"></i> Refresh</button>
            <button onclick="openWindow('my-computer-window')"><i class="fas fa-home"></i> Home</button>
        </div>
        <div class="window-body">
            <div class="blog-controls" id="blog-controls" style="display: none;">
                <button onclick="toggleBlogForm()">Add New Post</button>
            </div>
            <div class="blog-form" id="blog-form">
                <input type="text" id="blog-title" placeholder="Post Title">
                <input type="text" id="blog-image" placeholder="Image URL">
                <textarea id="blog-content" placeholder="Post Content"></textarea>
                <button onclick="saveBlogPost()">Save Post</button>
            </div>
            <div id="blog-posts"></div>
        </div>
        <div class="blog-status-bar">Ready</div>
    </div>
   
    <!-- CONTEXT MENU -->
    <div class="context-menu" id="context-menu">
        <ul>
            <li id="context-delete">Delete</li>
        </ul>
    </div>
   
    <!-- TASKBAR -->
    <div class="taskbar" style="display: none;">
        <button class="start-button" id="start-button">
            <img src="https://win98icons.alexmeub.com/icons/png/windows-0.png" alt="Start">
            <span>Start</span>
        </button>
        <div class="taskbar-apps" id="taskbar-apps"></div>
        <div class="taskbar-user" id="taskbar-user">Guest</div>
        <!-- AUDIO CONTROL MOVED HERE -->
        <div class="audio-control" onclick="toggleSound()">
            <i class="fas fa-volume-up" id="sound-icon"></i>
        </div>
        <button id="clippy-btn" onclick="toggleClippy()">Clippy</button>
        <div class="taskbar-time" id="taskbar-time"></div>
    </div>
   
    <!-- START MENU -->
    <div class="start-menu" id="start-menu">
        <ul>
            <!-- Menu items for projects and apps - add/remove li elements here -->
            <li onclick="openFriedrich()"><img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png">Friedrich</li>
            <li onclick="openTheNyrrik()"><img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png">The Nyrrik</li>
            <li onclick="openWanderlustTheRoadtrip()"><img src="https://win98icons.alexmeub.com/icons/png/joystick-5.png">Wanderlust: The Roadtrip</li>
            <li onclick="openMaxsGame()"><img src="https://win98icons.alexmeub.com/icons/png/joystick-5.png">Max's Game</li>
            <li onclick="openUndo()"><img src="https://win98icons.alexmeub.com/icons/png/joystick-5.png">Undo</li>
            <li onclick="openBerlinGirlMelody()"><img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png">Berlin-Girl: Melody</li>
            <li onclick="openWindow('about-window')"><img src="https://win98icons.alexmeub.com/icons/png/notepad_file-1.png">About Me</li>
            <li onclick="openWindow('blog-window')"><img src="https://win98icons.alexmeub.com/icons/png/msie2-5.png">My Blog</li>
            <li class="start-menu-separator"></li>
            <li onclick="openPaint()"><img src="https://win98icons.alexmeub.com/icons/png/paint_old-0.png">Paint</li>
            <li onclick="openWindow('pixelsweeper-window')"><img src="https://win98icons.alexmeub.com/icons/png/game_mine_2-1.png">PixelSweeper</li>
            <li onclick="openMaya()"><img src="https://images.seeklogo.com/logo-png/0/1/alias-maya-logo-png_seeklogo-6538.png">Maya 1.0</li>
            <li class="start-menu-separator"></li>
            <li id="login-logout-button" onclick="logout()"><img src="https://win98icons.alexmeub.com/icons/png/keys-4.png">Log Out</li>
        </ul>
    </div>
   
    <!-- CUSTOM CLIPPY -->
    <div id="custom-clippy">
        <img src="https://media1.tenor.com/m/CFEyyN92GaYAAAAC/clippy-head-scratch.gif" alt="Clippy">
    </div>
    <div id="speech-bubble">
        <p id="bubble-text"></p>
        <button id="yes-btn">Yes</button>
        <button id="no-btn">No</button>
    </div>
   
    <!-- EXTERNAL SCRIPTS -->
    <script src="https://unpkg.com/jquery@3.2.1"></script>
    
    <!-- PROJECT-SPECIFIC SCRIPTS -->
    <!-- Add or remove project scripts here -->
    <script src="friedrich.js"></script>
    <script src="the-nyrrik.js"></script>
    <script src="wanderlust-the-roadtrip.js"></script>
    <script src="maxs-game.js"></script>
    <script src="undo.js"></script>
    <script src="berlin-girl-melody.js"></script>
    
    <!-- OTHER SCRIPTS -->
    <script src="artifacts.js"></script>
    <script src="blog.js"></script>
    
    <!-- MAIN JAVASCRIPT CODE -->
    <script>
    // --- STATE AND CONFIG VARIABLES ---
    // These variables manage the app's state like user, windows, sounds, etc.
    let db; // IndexedDB database
    let currentUser = 'Guest'; // Current logged-in user
    let activeWindow = null; // Currently active window ID
    let openWindows = {}; // Object tracking open windows
    let highestZIndex = 10; // For stacking windows
    let soundEnabled = true; // Sound toggle
    let paintScriptLoaded = false; // Flag for if paint.js is loaded
    let ieScriptLoaded = true; // Flag for IE/blog script
    let friedrichScriptLoaded = false; // Flag for Friedrich script
    let mayaScriptLoaded = false; // Flag for Maya script
    let assistance = false; // Flag for Clippy assistance
    let clippyVisible = false; // Flag for Clippy visibility
   
    const correctUsername = "Malte Stoepke"; // Admin username
    const correctPassword = "Maus_123"; // Admin password
    
    // --- DOM ELEMENTS REFERENCES ---
    // Quick access to key elements
    const desktop = document.getElementById('desktop');
    const taskbar = document.querySelector('.taskbar');
    const taskbarApps = document.getElementById('taskbar-apps');
    const startMenu = document.getElementById('start-menu');
    const loginScreen = document.getElementById('login-screen');
    const loadingScreen = document.getElementById('loading-screen');
    const contextMenu = document.getElementById('context-menu');
    const clippy = document.getElementById('custom-clippy');
    const speechBubble = document.getElementById('speech-bubble');
    const bubbleText = document.getElementById('bubble-text');
    const yesBtn = document.getElementById('yes-btn');
    const noBtn = document.getElementById('no-btn');
   
    // --- INITIALIZATION FUNCTIONS ---
    // Runs when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        // Simulate loading progress bar
        let progress = 0;
        const interval = setInterval(() => {
            progress += 20;
            document.getElementById('loading-progress').style.width = progress + '%';
           
            if (progress >= 100) {
                clearInterval(interval);
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                   
                    // Initialize the OS after loading screen disappears
                    initOS();
                    // Play startup sound with a small delay after desktop is visible
                    setTimeout(() => {
                        document.getElementById('startup-sound').play().catch(e => console.log("Audio autoplay blocked."));
                    }, 500); // 500ms delay
                }, 500);
            }
        }, 200);
    });
    
    // Main init function
    function initOS() {
        // Auto login as guest
        guestLogin();
       
        // Initialize components
        initDB();
        updateClock();
        setupEventListeners();
        startMinesweeper(8, 8, 10); // Start minesweeper game with beginner settings
    }
    
    // Initialize IndexedDB
    function initDB() {
        const request = indexedDB.open('PortfolioOSDB', 4);
        request.onerror = (event) => {
            console.error("Database error: ", event.target.errorCode);
            guestLogin();
        };
       
        request.onsuccess = (event) => {
            db = event.target.result;
            console.log("Database opened successfully.");
            initBlog(db, currentUser); // Initialize blog with DB
        };
       
        request.onupgradeneeded = (event) => {
            let db = event.target.result;
            if (!db.objectStoreNames.contains('artworks')) {
                db.createObjectStore('artworks', { keyPath: 'id' });
            }
            if (!db.objectStoreNames.contains('blogPosts')) {
                db.createObjectStore('blogPosts', { keyPath: 'id', autoIncrement: true });
            }
        };
    }
   
    // Setup event listeners for interactions
    function setupEventListeners() {
        // Start Menu toggle
        document.getElementById('start-button').addEventListener('click', (e) => {
            e.stopPropagation();
            startMenu.classList.toggle('active');
            playSound('click-sound');
        });
        document.addEventListener('click', () => {
            startMenu.classList.remove('active');
            contextMenu.style.display = 'none';
        });
       
        // Window drag and controls
        document.querySelectorAll('.window').forEach(win => {
            const winId = win.id;
            const titleBar = win.querySelector('.title-bar');
           
            if (titleBar) {
                titleBar.addEventListener('mousedown', (e) => {
                    if (e.target.closest('.title-bar-controls')) return;
                    startDrag(e, win);
                    bringToFront(winId);
                });
            }
            const controls = win.querySelector('.title-bar-controls');
            if (controls) {
                controls.querySelector('[aria-label="Close"]')?.addEventListener('click', () => closeWindow(winId));
                controls.querySelector('[aria-label="Maximize"]')?.addEventListener('click', () => maximizeWindow(winId));
                controls.querySelector('[aria-label="Minimize"]')?.addEventListener('click', () => minimizeWindow(winId));
            }
            win.addEventListener('mousedown', () => bringToFront(winId));
        });
       
        // Desktop icon right-click for context menu (admin only)
        desktop.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            const icon = e.target.closest('.icon');
            if (currentUser === correctUsername && icon && icon.dataset.type === 'artwork') {
                showContextMenu(e.clientX, e.clientY, icon.dataset.id);
            }
        });
        contextMenu.addEventListener('click', e => e.stopPropagation());

        // Multiple selection with drag
        let selectionRect = null;
        let startX, startY;
        desktop.addEventListener('mousedown', (e) => {
            if (!e.target.closest('.icon')) {
                document.querySelectorAll('.icon.selected').forEach(i => i.classList.remove('selected'));
                startX = e.clientX;
                startY = e.clientY;
                selectionRect = document.createElement('div');
                selectionRect.className = 'selection-rect';
                selectionRect.style.left = `${startX}px`;
                selectionRect.style.top = `${startY}px`;
                desktop.appendChild(selectionRect);
            }
        });
        desktop.addEventListener('mousemove', (e) => {
            if (selectionRect) {
                const currentX = e.clientX;
                const currentY = e.clientY;
                selectionRect.style.width = `${Math.abs(currentX - startX)}px`;
                selectionRect.style.height = `${Math.abs(currentY - startY)}px`;
                selectionRect.style.left = `${Math.min(currentX, startX)}px`;
                selectionRect.style.top = `${Math.min(currentY, startY)}px`;
            }
        });
        desktop.addEventListener('mouseup', () => {
            if (selectionRect) {
                const rect = selectionRect.getBoundingClientRect();
                document.querySelectorAll('.icon').forEach(icon => {
                    const iconRect = icon.getBoundingClientRect();
                    if (iconRect.left < rect.right && iconRect.right > rect.left &&
                        iconRect.top < rect.bottom && iconRect.bottom > rect.top) {
                        icon.classList.add('selected');
                    }
                });
                selectionRect.remove();
                selectionRect = null;
            }
        });
    }
    
    // --- AUTHENTICATION FUNCTIONS ---
    // Login as admin
    function login() {
        const user = document.getElementById('username').value;
        const pass = document.getElementById('password').value;
        if (user === correctUsername && pass === correctPassword) {
            currentUser = correctUsername;
            loginScreen.style.display = 'none';
            updateUIAfterLogin();
            playSound('start-sound');
        } else {
            playSound('error-sound');
            alert("Incorrect username or password.");
        }
    }
    
    // Guest login
    function guestLogin() {
        currentUser = 'Guest';
        loginScreen.style.display = 'none';
        updateUIAfterLogin();
        playSound('click-sound');
    }
   
    // Logout function
    function logout() {
        currentUser = 'Guest';
        loginScreen.style.display = 'flex';
        updateUIAfterLogin();
        playSound('click-sound');
        Object.keys(openWindows).forEach(id => closeWindow(id));
    }
   
    // Update UI after login/logout
    function updateUIAfterLogin() {
        desktop.style.display = 'block';
        taskbar.style.display = 'flex';
       
        document.getElementById('taskbar-user').textContent = currentUser;
        const editControls = document.querySelectorAll('.edit-controls');
       
        if (currentUser === correctUsername) {
            document.getElementById('login-logout-button').innerHTML = `<img src="https://win98icons.alexmeub.com/icons/png/keys-4.png">Log Out`;
            document.getElementById('login-logout-button').onclick = logout;
           
            document.querySelectorAll('.editable-field').forEach(field => {
                field.contentEditable = true;
            });
            editControls.forEach(controls => {
                controls.style.display = 'block';
            });
        } else {
            document.getElementById('login-logout-button').innerHTML = `<img src="https://win98icons.alexmeub.com/icons/png/keys-4.png">Log In`;
            document.getElementById('login-logout-button').onclick = () => { loginScreen.style.display = 'flex'; };
           
            document.querySelectorAll('.editable-field').forEach(field => {
                field.contentEditable = false;
            });
            editControls.forEach(controls => {
                controls.style.display = 'none';
            });
        }
       
        setupIconInteraction(); // Setup draggable icons and clicks
        updateBlogUI(currentUser); // Update blog based on user
        initCustomClippy(); // Show Clippy after desktop is visible
    }
   
    // --- CLOCK FUNCTION ---
    // Static clock for last update
    function updateClock() {
        document.getElementById('taskbar-time').textContent = 'Last Update: 08/01/2025';
    }
   
    // --- WINDOW MANAGEMENT FUNCTIONS ---
    // Open a window by ID
    function openWindow(winId) {
        const win = document.getElementById(winId);
        if (!win) return;
       
        win.style.display = 'block';
        bringToFront(winId);
        playSound('window-open-sound');
        if (!openWindows[winId]) {
            createTaskbarApp(winId);
        }
        openWindows[winId] = { minimized: false };
        updateTaskbar();
        startMenu.classList.remove('active');
        if (assistance) {
            let explanation = '';
            switch (winId) {
                case 'my-computer-window':
                    explanation = 'This is My Computer. It contains access to my portfolio and blog.';
                    break;
                case 'about-window':
                    explanation = 'Read about me in this Notepad file.';
                    break;
                case 'paint-window':
                    explanation = 'Use Paint to create your own artwork and save it to the desktop.';
                    break;
                case 'pixelsweeper-window':
                    explanation = 'Play PixelSweeper, a Minesweeper clone.';
                    break;
                case 'recycle-window':
                    explanation = 'Dive into the chaotic Recycle Bin—full of unfinished madness with wild animations!';
                    break;
                case 'friedrich-window':
                    explanation = 'Explore the Friedrich project, showcasing a character design with various emotions and technical details.';
                    break;
                case 'maya-window':
                    explanation = 'This is Maya 1.0, a 3D modeling application with interactive controls.';
                    break;
                case 'blog-window':
                    explanation = 'Check out my blog! Click posts to view them or add new ones if you\'re logged in as admin.';
                    break;
                default:
                    if (winId.startsWith('blog-post-window')) {
                        explanation = 'This is a blog post. Enjoy reading!';
                    }
            }
            if (explanation) {
                showSpeechBubble(explanation);
            }
        }
    }
   
    // Open Paint window and load script if needed
    function openPaint() {
        const winId = 'paint-window';
        let win = document.getElementById(winId);
        if (!win) {
            win = document.createElement('div');
            win.className = 'window';
            win.id = winId;
            win.style.width = '500px';
            win.style.height = '400px';
            win.innerHTML = `
                <div class="title-bar">
                    <div class="title-bar-text">untitled - Paint</div>
                    <div class="title-bar-controls">
                        <button aria-label="Minimize" onclick="minimizeWindow('paint-window')"></button>
                        <button aria-label="Maximize" onclick="maximizeWindow('paint-window')"></button>
                        <button aria-label="Close" onclick="closeWindow('paint-window')"></button>
                    </div>
                </div>
                <div class="window-body">
                    <div class="paint-tools">
                        <div class="tool-button active" id="pencil-tool" onclick="setTool('pencil')">
                            <i class="fas fa-pencil-alt"></i>
                        </div>
                        <div class="tool-button" id="brush-tool" onclick="setTool('brush')">
                            <i class="fas fa-paint-brush"></i>
                        </div>
                        <div class="tool-button" id="eraser-tool" onclick="setTool('eraser')">
                            <i class="fas fa-eraser"></i>
                        </div>
                        <div class="tool-button" id="fill-tool" onclick="setTool('fill')">
                            <i class="fas fa-fill-drip"></i>
                        </div>
                        <div class="tool-button" id="pick-tool" onclick="setTool('pick')">
                            <i class="fas fa-eye-dropper"></i>
                        </div>
                        <div class="tool-button" id="magnifier-tool" onclick="setTool('magnifier')">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="tool-button" id="text-tool" onclick="setTool('text')">
                            <i class="fas fa-font"></i>
                        </div>
                        <div class="tool-button" id="line-tool" onclick="setTool('line')">
                            <i class="fas fa-slash"></i>
                        </div>
                        <div class="tool-button" id="curve-tool" onclick="setTool('curve')">
                            <i class="fas fa-bezier-curve"></i>
                        </div>
                        <div class="tool-button" id="rectangle-tool" onclick="setTool('rectangle')">
                            <i class="fas fa-square"></i>
                        </div>
                        <div class="tool-button" id="ellipse-tool" onclick="setTool('ellipse')">
                            <i class="fas fa-circle"></i>
                        </div>
                        <div class="tool-button" id="rounded-rectangle-tool" onclick="setTool('rounded-rectangle')">
                            <i class="fas fa-square-full"></i>
                        </div>
                        <div class="tool-button" id="polygon-tool" onclick="setTool('polygon')">
                            <i class="fas fa-draw-polygon"></i>
                        </div>
                        <div class="tool-button" id="select-tool" onclick="setTool('select')">
                            <i class="fas fa-object-ungroup"></i>
                        </div>
                        <div class="tool-button" id="free-select-tool" onclick="setTool('free-select')">
                            <i class="fas fa-lasso"></i>
                        </div>
                        <div class="tool-button" onclick="clearCanvas()">
                            <i class="fas fa-trash"></i>
                        </div>
                        <button class="login-button" onclick="saveArtwork()" style="margin-left: 10px;">
                            <i class="fas fa-save"></i> Save to Desktop
                        </button>
                    </div>
                    <canvas id="paint-canvas" class="paint-canvas" width="480" height="320"></canvas>
                    <div class="color-picker">
                        <div class="color-option selected" style="background: black;" onclick="setColor('black')"></div>
                        <div class="color-option" style="background: red;" onclick="setColor('red')"></div>
                        <div class="color-option" style="background: green;" onclick="setColor('green')"></div>
                        <div class="color-option" style="background: blue;" onclick="setColor('blue')"></div>
                        <div class="color-option" style="background: yellow;" onclick="setColor('yellow')"></div>
                        <div class="color-option" style="background: purple;" onclick="setColor('purple')"></div>
                        <div class="color-option" style="background: orange;" onclick="setColor('orange')"></div>
                        <div class="color-option" style="background: pink;" onclick="setColor('pink')"></div>
                    </div>
                </div>
            `;
            document.body.appendChild(win);
            const titleBar = win.querySelector('.title-bar');
            if (titleBar) {
                titleBar.addEventListener('mousedown', (e) => {
                    if (e.target.closest('.title-bar-controls')) return;
                    startDrag(e, win);
                    bringToFront(winId);
                });
            }
            win.addEventListener('mousedown', () => bringToFront(winId));
        }
        if (!paintScriptLoaded) {
            const script = document.createElement('script');
            script.src = 'paint.js';
            script.onload = () => {
                paintScriptLoaded = true;
                console.log('paint.js loaded successfully');
                if (typeof initPaint === 'function') {
                    initPaint();
                    openWindow(winId);
                } else {
                    playSound('error-sound');
                    alert('Failed to initialize Paint application.');
                }
            };
            script.onerror = () => {
                console.error('Failed to load paint.js');
                playSound('error-sound');
                alert('Failed to load Paint application.');
            };
            document.body.appendChild(script);
        } else {
            if (typeof initPaint === 'function') {
                initPaint();
            }
            openWindow(winId);
        }
        if (assistance) {
            showSpeechBubble('Use Paint to create your own artwork and save it to the desktop.');
        }
    }
   
    // Open Maya window and load script if needed
    function openMaya() {
        console.log('Attempting to open Maya 1.0');
        if (!mayaScriptLoaded) {
            const script = document.createElement('script');
            script.src = 'maya.js';
            script.onload = () => {
                console.log('maya.js loaded successfully');
                mayaScriptLoaded = true;
                initMaya();
                openWindow('maya-window');
            };
            script.onerror = () => {
                console.error('Failed to load maya.js');
                playSound('error-sound');
                alert('Failed to load Maya 1.0 application.');
            };
            document.body.appendChild(script);
        } else {
            console.log('Maya script already loaded, opening window');
            openWindow('maya-window');
        }
        if (assistance) {
            showSpeechBubble('This is Maya 1.0, a 3D modeling application with interactive controls.');
        }
    }
   
    // Close a window
    function closeWindow(winId) {
        const win = document.getElementById(winId);
        if (win) {
            win.style.display = 'none';
            playSound('window-close-sound');
        }
       
        delete openWindows[winId];
        if (activeWindow === winId) activeWindow = null;
        updateTaskbar();
    }
    
    // Minimize a window
    function minimizeWindow(winId) {
        const win = document.getElementById(winId);
        if (win) {
            win.style.display = 'none';
            playSound('click-sound');
        }
        if (openWindows[winId]) {
            openWindows[winId].minimized = true;
        }
        if (activeWindow === winId) activeWindow = null;
        updateTaskbar();
    }
   
    // Maximize a window
    function maximizeWindow(winId) {
        const win = document.getElementById(winId);
        if (win) {
            win.classList.toggle('maximized');
            playSound('click-sound');
            if (win.classList.contains('maximized')) {
                win.style.top = '';
                win.style.left = '';
                win.style.width = '';
                win.style.height = '';
            }
        }
    }
   
    // Bring window to front
    function bringToFront(winId) {
        if (activeWindow === winId) return;
       
        highestZIndex++;
        const win = document.getElementById(winId);
        if (win) {
            win.style.zIndex = highestZIndex;
           
            if (openWindows[winId] && openWindows[winId].minimized) {
                openWindows[winId].minimized = false;
                win.style.display = 'block';
            }
        }
       
        activeWindow = winId;
        updateTaskbar();
    }
   
    // Drag window function
    function startDrag(e, element) {
        let offsetX = e.clientX - element.offsetLeft;
        let offsetY = e.clientY - element.offsetTop;
        function drag(e) {
            if (element.classList.contains('maximized')) return;
            element.style.left = `${e.clientX - offsetX}px`;
            element.style.top = `${e.clientY - offsetY}px`;
        }
        function stopDrag() {
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
            if (assistance) {
                showSpeechBubble('You just dragged a window! Try opening About Me next.');
            }
        }
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', stopDrag);
    }
   
    // --- TASKBAR FUNCTIONS ---
    // Create taskbar button for open window
    function createTaskbarApp(winId) {
        const win = document.getElementById(winId);
        const title = win.querySelector('.title-bar-text').textContent;
       
        const app = document.createElement('button');
        app.className = 'taskbar-app';
        app.textContent = title;
        app.dataset.winId = winId;
        app.onclick = () => {
            bringToFront(winId);
        };
        taskbarApps.appendChild(app);
    }
   
    // Update taskbar buttons state
    function updateTaskbar() {
        const apps = taskbarApps.querySelectorAll('.taskbar-app');
        apps.forEach(app => {
            const winId = app.dataset.winId;
            if (!openWindows[winId]) {
                app.remove();
                return;
            }
           
            if (winId === activeWindow && !openWindows[winId].minimized) {
                app.classList.add('active');
            } else {
                app.classList.remove('active');
            }
        });
    }
    
    // --- DESKTOP ICON FUNCTIONS ---
    // Setup interactions for icons (drag, click, etc.)
    function setupIconInteraction() {
        console.log('Setting up Definicion de iconos');
        document.querySelectorAll('.icon').forEach(icon => {
            console.log(`Processing icon: ${icon.dataset.id}`);
            const newIcon = icon.cloneNode(true);
            icon.parentNode.replaceChild(newIcon, icon);
            const savedPos = localStorage.getItem(`iconpos_${newIcon.dataset.id}`);
            if (savedPos) {
                const { top, left } = JSON.parse(savedPos);
                newIcon.style.top = top;
                newIcon.style.left = left;
            }
            if (currentUser === correctUsername) {
                newIcon.classList.add('draggable');
                makeIconDraggable(newIcon);
            } else {
                newIcon.classList.remove('draggable');
            }
           
            newIcon.addEventListener('dblclick', () => {
                console.log(`Double-clicked icon: ${newIcon.dataset.id}`);
                const windowId = newIcon.dataset.id === 'paint' ? null :
                                newIcon.dataset.id === 'friedrich' ? null :
                                newIcon.dataset.id === 'maya' ? null :
                                `${newIcon.dataset.id}-window`;
                if (newIcon.dataset.id === 'paint') {
                    openPaint();
                } else if (newIcon.dataset.id === 'friedrich') {
                    openFriedrich();
                } else if (newIcon.dataset.id === 'maya') {
                    openMaya();
                } else {
                    openWindow(windowId);
                }
                if (assistance) {
                    let explanation = '';
                    switch (newIcon.dataset.id) {
                        case 'my-computer':
                            explanation = 'This is My Computer. It contains access to my portfolio and blog.';
                            break;
                        case 'about':
                            explanation = 'Read about me in this Notepad file.';
                            break;
                        case 'paint':
                            explanation = 'Use Paint to create your own artwork and save it to the desktop.';
                            break;
                        case 'pixelsweeper':
                            explanation = 'Play PixelSweeper, a Minesweeper clone.';
                            break;
                        case 'recycle':
                            explanation = 'Dive into the chaotic Recycle Bin—full of unfinished madness with wild animations!';
                            break;
                        case 'friedrich':
                            explanation = 'Explore the Friedrich project, showcasing a character design with various emotions and technical details.';
                            break;
                        case 'the-nyrrik':
                            explanation = 'Open the Nyrrik folder to see my latest creature design.';
                            break;
                        case 'wanderlust-the-roadtrip':
                            explanation = 'Check out Wanderlust: The Roadtrip, a student project for Bosch.';
                            break;
                        case 'maxs-game':
                            explanation = 'Play Max\'s Game, a fun interactive experience.';
                            break;
                        case 'undo':
                            explanation = 'Undo folder contains experimental works.';
                            break;
                        case 'berlin-girl-melody':
                            explanation = 'Discover Berlin-Girl: Melody, a character with a unique story.';
                            break;
                        case 'maya':
                            explanation = 'This is Maya 1.0, a 3D modeling application with interactive controls.';
                            break;
                        case 'blog':
                            explanation = 'Check out my blog! Click posts to view them or add new ones if you\'re logged in as admin.';
                            break;
                        case 'artstation':
                            explanation = 'Visit my ArtStation profile in a new tab.';
                            break;
                    }
                    if (explanation) {
                        showSpeechBubble(explanation);
                    }
                }
            });
            newIcon.addEventListener('click', (e) => {
                e.stopPropagation();
                document.querySelectorAll('.icon.selected').forEach(i => i.classList.remove('selected'));
                newIcon.classList.add('selected');
            });
        });
       
        desktop.addEventListener('click', () => {
            document.querySelectorAll('.icon.selected').forEach(i => i.classList.remove('selected'));
        });
    }
    
    // Make icon draggable (admin only)
    function makeIconDraggable(icon) {
        icon.addEventListener('mousedown', e => {
            e.preventDefault();
            e.stopPropagation();
            let offsetX = e.clientX - icon.offsetLeft;
            let offsetY = e.clientY - icon.offsetTop;
            function drag(e) {
                icon.style.left = `${e.clientX - offsetX}px`;
                icon.style.top = `${e.clientY - offsetY}px`;
            }
            function stopDrag() {
                localStorage.setItem(`iconpos_${icon.dataset.id}`, JSON.stringify({ top: icon.style.top, left: icon.style.left }));
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
                if (assistance) {
                    showSpeechBubble('You just dragged a window! Try opening About Me next.');
                }
            }
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        });
    }
    
    // --- CONTEXT MENU FUNCTIONS ---
    // Show context menu for delete (admin only)
    function showContextMenu(x, y, id) {
        contextMenu.style.top = `${y}px`;
        contextMenu.style.left = `${x}px`;
        contextMenu.style.display = 'block';
        const deleteBtn = document.getElementById('context-delete');
        deleteBtn.onclick = () => {
            if (confirm("Are you sure you want to delete this item?")) {
                if (id.includes('blog-post')) {
                    deleteBlogPost(parseInt(id.replace('blog-post-', '')));
                } else {
                    deleteArtwork(id);
                }
            }
            contextMenu.style.display = 'none';
        };
    }
    
    // --- INDEXEDDB FUNCTIONS FOR ARTWORKS ---
    // Add new artwork to DB
    function addArtwork(artwork) {
        const transaction = db.transaction(['artworks'], 'readwrite');
        const store = transaction.objectStore('artworks');
        store.add(artwork);
        transaction.oncomplete = () => {
            playSound('click-sound');
            alert('Artwork added!');
        };
        transaction.onerror = (e) => console.error('Error adding artwork:', e);
    }
    
    // Delete artwork from DB
    function deleteArtwork(id) {
        const transaction = db.transaction(['artworks'], 'readwrite');
        const store = transaction.objectStore('artworks');
        store.delete(id);
        transaction.oncomplete = () => {
            playSound('click-sound');
        };
    }
   
    // Save edits to about section (localStorage)
    function saveAboutEdits() {
        const bio = document.getElementById('about-bio').innerHTML;
        const desc = document.getElementById('about-desc').innerHTML;
        const contact = document.getElementById('about-contact').innerHTML;
       
        const aboutData = { bio, desc, contact };
        localStorage.setItem('aboutData', JSON.stringify(aboutData));
       
        playSound('click-sound');
        alert('About information updated!');
    }
    
    // --- BLOG NAVIGATION DUMMY FUNCTIONS ---
    // Back button (dummy)
    function goBack() {
        playSound('click-sound');
        document.querySelector('.blog-status-bar').textContent = 'Navigating back...';
        setTimeout(() => {
            document.querySelector('.blog-status-bar').textContent = 'Ready';
        }, 1000);
    }
    
    // Forward button (dummy)
    function goForward() {
        playSound('click-sound');
        document.querySelector('.blog-status-bar').textContent = 'Navigating forward...';
        setTimeout(() => {
            document.querySelector('.blog-status-bar').textContent = 'Ready';
        }, 1000);
    }
    
    // Refresh blog
    function refreshBlog() {
        playSound('click-sound');
        document.querySelector('.blog-status-bar').textContent = 'Refreshing...';
        loadBlogPosts(db, currentUser);
        setTimeout(() => {
            document.querySelector('.blog-status-bar').textContent = 'Ready';
        }, 1000);
    }
    
    // --- APPLICATION FUNCTIONS ---
    // Minesweeper (PixelSweeper) game logic
    function startMinesweeper(width, height, mineCount) {
        const boardEl = document.getElementById('minesweeper-board');
        boardEl.innerHTML = '';
        boardEl.style.gridTemplateColumns = `repeat(${width}, 20px)`;
       
        let board = [];
        let mines = [];
        let revealed = [];
       
        for (let r = 0; r < height; r++) {
            board[r] = [];
            revealed[r] = [];
            for (let c = 0; c < width; c++) {
                board[r][c] = 0;
                revealed[r][c] = false;
               
                const cell = document.createElement('div');
                cell.className = 'minesweeper-cell';
                cell.dataset.row = r;
                cell.dataset.col = c;
                boardEl.appendChild(cell);
            }
        }
       
        let minesPlaced = 0;
        while (minesPlaced < mineCount) {
            const r = Math.floor(Math.random() * height);
            const c = Math.floor(Math.random() * width);
            if (!board[r][c].mine) {
                mines.push({r, c});
                board[r][c] = 'X';
                minesPlaced++;
               
                for (let i = -1; i <= 1; i++) {
                    for (let j = -1; j <= 1; j++) {
                        if (i === 0 && j === 0) continue;
                        const nr = r + i, nc = c + j;
                        if (nr >= 0 && nr < height && nc >= 0 && nc < width && board[nr][nc] !== 'X') {
                            board[nr][nc]++;
                        }
                    }
                }
            }
        }
       
        boardEl.addEventListener('click', (e) => {
            const cell = e.target.closest('.minesweeper-cell');
            if (!cell) return;
           
            const r = parseInt(cell.dataset.row);
            const c = parseInt(cell.dataset.col);
           
            if (board[r][c] === 'X') {
                cell.classList.add('mine');
                cell.innerHTML = '💣';
                playSound('error-sound');
                alert('Game Over!');
                startMinesweeper(8, 8, 10);
            } else {
                revealed[r][c] = true;
                cell.classList.add('revealed');
                cell.textContent = board[r][c] > 0 ? board[r][c] : '';
                if (board[r][c] > 0) {
                    cell.classList.add(`color-${board[r][c]}`);
                }
               
                if (board[r][c] === 0) {
                    revealAdjacent(r, c, board, revealed);
                }
               
                if (checkWin(board, revealed, mines.length)) {
                    playSound('click-sound');
                    alert('Congratulations! You won!');
                    startMinesweeper(8, 8, 10);
                }
            }
        });
       
        // Reveal adjacent cells for zero mines
        function revealAdjacent(r, c, board, revealed) {
            for (let i = -1; i <= 1; i++) {
                for (let j = -1; j <= 1; j++) {
                    if (i === 0 && j === 0) continue;
                    const nr = r + i, nc = c + j;
                    if (nr >= 0 && nr < height && nc >= 0 && nc < width && !revealed[nr][nc]) {
                        revealed[nr][nc] = true;
                        const cell = document.querySelector(`.minesweeper-cell[data-row="${nr}"][data-col="${nc}"]`);
                        cell.classList.add('revealed');
                        cell.textContent = board[nr][nc] > 0 ? board[nr][nc] : '';
                        if (board[nr][nc] > 0) {
                            cell.classList.add(`color-${board[nr][nc]}`);
                        }
                        if (board[nr][nc] === 0) {
                            revealAdjacent(nr, nc, board, revealed);
                        }
                    }
                }
            }
        }
       
        // Check if game is won
        function checkWin(board, revealed, mineCount) {
            let safeRevealed = 0;
            for (let r = 0; r < height; r++) {
                for (let c = 0; c < width; c++) {
                    if (board[r][c] !== 'X' && revealed[r][c]) {
                        safeRevealed++;
                    }
                }
            }
            return safeRevealed === (width * height - mineCount);
        }
    }
   
    // --- AUDIO CONTROL FUNCTIONS ---
    // Play a sound by ID
    function playSound(id) {
        if (!soundEnabled) return;
        const sound = document.getElementById(id);
        sound.currentTime = 0;
        sound.play().catch(e => console.log("Sound play prevented:", e));
    }
   
    // Toggle sound on/off
    function toggleSound() {
        soundEnabled = !soundEnabled;
        document.getElementById('sound-icon').className = soundEnabled ?
            'fas fa-volume-up' : 'fas fa-volume-mute';
        playSound('click-sound');
    }
    
    // --- CLIPPY ASSISTANT ---
    // Dialog tree for actions (easy to extend!)
    const clippyDialog = {
      'init': {
        text: "Hi! I'm Clippy, your friendly office assistant. How can I help you explore Malte Stoepke's portfolio?",
        buttons: [
          { label: "Show me around!", action: "intro" },
          { label: "What is this site?", action: "siteinfo" },
          { label: "No thanks", action: "hide" }
        ]
      },
      'intro': {
        text: "Double-click any icon to learn more. Want a suggestion?",
        buttons: [
          { label: "About Me.txt", action: "about" },
          { label: "Show 3D Projects", action: "show3d" },
          { label: "Surprise me!", action: "random" }
        ]
      },
      'siteinfo': {
        text: "This is Malte Stoepke's interactive portfolio, styled like Windows 98! Explore artwork, games, blog, and more.",
        buttons: [
          { label: "Show me around!", action: "intro" },
          { label: "Back", action: "init" }
        ]
      },
      'about': {
        text: "‘About Me.txt’ contains a quick summary about Malte. Want a preview?",
        buttons: [
          { label: "Show preview", action: "aboutPreview" },
          { label: "Open About Me.txt", action: "openAbout" },
          { label: "Back", action: "intro" }
        ]
      },
      'aboutPreview': {
        text: "Malte Stoepke is a creative 3D artist and game developer. Want to read the full story?",
        buttons: [
          { label: "Open About Me.txt", action: "openAbout" },
          { label: "Back", action: "about" }
        ]
      },
      'openAbout': {
        text: "Opening About Me.txt...",
        buttons: []
      },
      'show3d': {
        text: "Check out Malte’s 3D projects like Maya 1.0, Friedrich, Undo, and Max’s Game. Which one interests you?",
        buttons: [
          { label: "Maya 1.0", action: "maya" },
          { label: "Friedrich", action: "friedrich" },
          { label: "Undo", action: "undo" }
        ]
      },
      'maya': {
        text: "Maya 1.0 is a project exploring the roots of 3D development. Would you like to know why it was made, see a demo, or explore more 3D work?",
        buttons: [
          { label: "Why?", action: "mayaWhy" },
          { label: "Demo", action: "mayaDemo" },
          { label: "More 3D", action: "show3d" }
        ]
      },
      'mayaWhy': {
        text: "Malte created Maya 1.0 to learn about the origin of digital 3D art and tools.",
        buttons: [
          { label: "Back", action: "maya" },
          { label: "More 3D", action: "show3d" }
        ]
      },
      'mayaDemo': {
        text: "Launching the Maya 1.0 demo...",
        buttons: [
          { label: "Back", action: "maya" }
        ]
      },
      'friedrich': {
        text: "Friedrich is a 3D project by Malte. Want to know more?",
        buttons: [
          { label: "Why?", action: "friedrichWhy" },
          { label: "Back", action: "show3d" }
        ]
      },
      'friedrichWhy': {
        text: "Friedrich explores unique character modeling and animation.",
        buttons: [
          { label: "Back", action: "friedrich" }
        ]
      },
      'undo': {
        text: "Undo is a time-reversal puzzle game. Curious about the concept?",
        buttons: [
          { label: "Why?", action: "undoWhy" },
          { label: "Back", action: "show3d" }
        ]
      },
      'undoWhy': {
        text: "Undo lets you experiment with time mechanics in gameplay.",
        buttons: [
          { label: "Back", action: "undo" }
        ]
      },
      // Add more dialog nodes as needed...
      'random': {
        text: "Try double-clicking any icon, or let me suggest: ‘About Me.txt’ or ‘Maya 1.0’.",
        buttons: [
          { label: "About Me.txt", action: "about" },
          { label: "Maya 1.0", action: "maya" }
        ]
      },
      'hide': {
        text: "Okay, I'll hide for now. Call me anytime!",
        buttons: []
      }
    };

    // Typewriter effect for speech bubble
    function typeWriter(text, callback) {
      speechBubble.innerHTML = '';
      let i = 0;
      function typing() {
        if (i < text.length) {
          speechBubble.innerHTML += text.charAt(i);
          i++;
          setTimeout(typing, 20);
        } else {
          if (callback) callback();
        }
      }
      typing();
    }

    // Show speech bubble with options
    function showSpeechBubble(clippyState) {
      const dialog = clippyDialog[clippyState];
      if (!dialog) return;
      typeWriter(dialog.text, () => {
        if (dialog.buttons && dialog.buttons.length) {
          const btnDiv = document.createElement('div');
          btnDiv.style.marginTop = '10px';
          dialog.buttons.forEach(btn => {
            const button = document.createElement('button');
            button.textContent = btn.label;
            button.onclick = () => {
              if (btn.action === 'hide') {
                speechBubble.style.display = 'none';
                clippy.style.display = 'none';
                clippyVisible = false;
              } else if (btn.action === 'openAbout') {
                // Trigger your About Me window opening code here:
                openWindow('about-window');
                showSpeechBubble('about'); // Return to dialog after opening window
              } else if (btn.action === 'mayaDemo') {
                openMaya(); // Launch Maya window
                showSpeechBubble('maya');
              } else {
                showSpeechBubble(btn.action);
              }
            };
            btnDiv.appendChild(button);
          });
          speechBubble.appendChild(btnDiv);
        }
      });
      speechBubble.style.display = 'block';
      clippy.style.display = 'block';
      clippyVisible = true;
    }

    // Clippy startup
    function initCustomClippy() {
      clippy.style.display = 'block';
      showSpeechBubble('init');
    }

    // Optional: toggle Clippy on/off (can be called from your taskbar button)
    function toggleClippy() {
      if (clippyVisible) {
        clippy.style.display = 'none';
        speechBubble.style.display = 'none';
        clippyVisible = false;
      } else {
        clippy.style.display = 'block';
        showSpeechBubble('init');
        clippyVisible = true;
      }
    }

    // Clippy moves to a random location when called
    function animateClippy() {
      const randomX = Math.random() * (window.innerWidth - 100);
      const randomY = Math.random() * (window.innerHeight - 150);
      clippy.style.left = `${randomX}px`;
      clippy.style.top = `${randomY}px`;
    }
    
    // --- PROJECT FUNCTIONS ---
    function openFriedrich() {
        console.log("Opening Friedrich project");
        openWindow('my-computer-window');
    }
    
    function openTheNyrrik() {
        console.log("Opening The Nyrrik project");
        openWindow('my-computer-window');
    }
    
    function openBerlinGirlMelody() {
        console.log("Opening Berlin-Girl: Melody project");
        openWindow('my-computer-window');
    }
    
    function openWanderlustTheRoadtrip() {
        console.log("Opening Wanderlust: The Roadtrip project");
        openWindow('my-computer-window');
    }
    
    function openMaxsGame() {
        console.log("Opening Max's Game project");
        openWindow('my-computer-window');
    }
    
    function openUndo() {
        console.log("Opening Undo project");
        openWindow('my-computer-window');
    }
    
    // Initialize Maya (dummy function)
    function initMaya() {
        console.log("Initializing Maya 1.0");
        const canvas = document.getElementById('maya-canvas');
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#c0c0c0';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.font = '16px Arial';
        ctx.fillStyle = '#000080';
        ctx.textAlign = 'center';
        ctx.fillText('Maya 1.0 - 3D Modeling Application', canvas.width/2, canvas.height/2);
        ctx.fillText('Use tools to create 3D models', canvas.width/2, canvas.height/2 + 30);
    }
    </script>
</body>
</html>
